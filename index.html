<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    
    <!-- Web App Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Spanish Cards">
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.imgur.com/gT7h4v4.png">

    <title>Spanish Flashcards</title>
    
    <!-- Scripts -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Styles -->
    <style>
        .perspective-1000 { perspective: 1000px; }
        .transform-style-preserve-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        * { -webkit-tap-highlight-color: transparent; }
    </style>
</head>
<body class="overscroll-none">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Icon Components ---
        const ChevronLeftIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
            </svg>
        );
        const ChevronRightIcon = () => (
            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5l7 7-7 7" />
            </svg>
        );
        const RefreshIcon = () => (
            <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );
        const SpeakerIcon = () => (
             <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"></path>
            </svg>
        );

        // --- Main App Component ---
        const SpanishFlashcards = () => {
            // --- REDUCED DATA SETS (for better performance) ---
            const dataSets = {
                "Essential Verbs": [
                    { spanish: "ser", english: "to be (permanent)", type: "verb" },
                    { spanish: "estar", english: "to be (temporary)", type: "verb" },
                    { spanish: "tener", english: "to have", type: "verb" },
                    { spanish: "hacer", english: "to do/make", type: "verb" },
                    { spanish: "ir", english: "to go", type: "verb" },
                    { spanish: "venir", english: "to come", type: "verb" },
                    { spanish: "querer", english: "to want/love", type: "verb" },
                    { spanish: "poder", english: "to be able", type: "verb" },
                    { spanish: "decir", english: "to say/tell", type: "verb" },
                    { spanish: "dar", english: "to give", type: "verb" },
                    { spanish: "ver", english: "to see", type: "verb" },
                    { spanish: "saber", english: "to know", type: "verb" },
                    { spanish: "hablar", english: "to speak", type: "verb" },
                    { spanish: "comer", english: "to eat", type: "verb" },
                    { spanish: "beber", english: "to drink", type: "verb" }
                ],
                "Daily Activities": [
                    { spanish: "dormir", english: "to sleep", type: "verb" },
                    { spanish: "despertar", english: "to wake up", type: "verb" },
                    { spanish: "levantarse", english: "to get up", type: "verb" },
                    { spanish: "ducharse", english: "to shower", type: "verb" },
                    { spanish: "trabajar", english: "to work", type: "verb" },
                    { spanish: "estudiar", english: "to study", type: "verb" },
                    { spanish: "leer", english: "to read", type: "verb" },
                    { spanish: "escribir", english: "to write", type: "verb" },
                    { spanish: "cocinar", english: "to cook", type: "verb" },
                    { spanish: "limpiar", english: "to clean", type: "verb" }
                ],
                "Common Nouns": [
                    { spanish: "casa", english: "house", type: "noun" },
                    { spanish: "familia", english: "family", type: "noun" },
                    { spanish: "amigo", english: "friend", type: "noun" },
                    { spanish: "tiempo", english: "time/weather", type: "noun" },
                    { spanish: "día", english: "day", type: "noun" },
                    { spanish: "año", english: "year", type: "noun" },
                    { spanish: "trabajo", english: "work/job", type: "noun" },
                    { spanish: "dinero", english: "money", type: "noun" },
                    { spanish: "comida", english: "food", type: "noun" },
                    { spanish: "agua", english: "water", type: "noun" },
                    { spanish: "libro", english: "book", type: "noun" },
                    { spanish: "teléfono", english: "telephone", type: "noun" },
                    { spanish: "coche", english: "car", type: "noun" },
                    { spanish: "mesa", english: "table", type: "noun" },
                    { spanish: "silla", english: "chair", type: "noun" }
                ],
                "Basic Phrases": [
                    { spanish: "Hola", english: "Hello", type: "phrase" },
                    { spanish: "¿Cómo estás?", english: "How are you?", type: "phrase" },
                    { spanish: "Muy bien, gracias", english: "Very well, thank you", type: "phrase" },
                    { spanish: "Por favor", english: "Please", type: "phrase" },
                    { spanish: "Gracias", english: "Thank you", type: "phrase" },
                    { spanish: "De nada", english: "You're welcome", type: "phrase" },
                    { spanish: "Lo siento", english: "I'm sorry", type: "phrase" },
                    { spanish: "¿Habla inglés?", english: "Do you speak English?", type: "phrase" },
                    { spanish: "No entiendo", english: "I don't understand", type: "phrase" },
                    { spanish: "¿Cuánto cuesta?", english: "How much does it cost?", type: "phrase" },
                    { spanish: "¿Dónde está...?", english: "Where is...?", type: "phrase" },
                    { spanish: "Me llamo...", english: "My name is...", type: "phrase" },
                    { spanish: "Mucho gusto", english: "Nice to meet you", type: "phrase" },
                    { spanish: "Hasta luego", english: "See you later", type: "phrase" },
                    { spanish: "Buenos días", english: "Good morning", type: "phrase" }
                ]
            };

            // --- STATE MANAGEMENT ---
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);
            const [mode, setMode] = useState('spanish-to-english');
            const [selectedSet, setSelectedSet] = useState('Essential Verbs');
            const [touchStart, setTouchStart] = useState(null);

            // Get cards from selected set
            const cards = dataSets[selectedSet] || [];

            // --- HELPER FUNCTIONS ---
            const speakText = (text, lang = 'es-ES') => {
                if (!('speechSynthesis' in window)) return;
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang;
                utterance.rate = 0.9;
                setTimeout(() => window.speechSynthesis.speak(utterance), 50);
            };

            // --- EVENT HANDLERS ---
            const handleFlip = () => setIsFlipped(!isFlipped);
            const handleNext = () => { if (currentIndex < cards.length - 1) { setCurrentIndex(currentIndex + 1); setIsFlipped(false); } };
            const handlePrevious = () => { if (currentIndex > 0) { setCurrentIndex(currentIndex - 1); setIsFlipped(false); } };
            const handleReset = () => { setCurrentIndex(0); setIsFlipped(false); };
            const handleModeToggle = () => { setMode(prev => prev === 'spanish-to-english' ? 'english-to-spanish' : 'spanish-to-english'); setIsFlipped(false); };
            
            const handleAudio = () => {
                const currentCard = cards[currentIndex];
                if (currentCard) {
                    const textToSpeak = mode === 'spanish-to-english' || isFlipped ? currentCard.spanish : currentCard.english;
                    const lang = mode === 'spanish-to-english' || isFlipped ? 'es-ES' : 'en-US';
                    speakText(textToSpeak, lang);
                }
            };

            // Touch handling for swipe
            const onTouchStart = (e) => setTouchStart(e.targetTouches[0].clientX);
            const onTouchEnd = (e) => {
                if (!touchStart) return;
                const touchEnd = e.changedTouches[0].clientX;
                const diff = touchStart - touchEnd;
                if (Math.abs(diff) > 50) {
                    if (diff > 0) handleNext();
                    else handlePrevious();
                } else {
                    handleFlip();
                }
                setTouchStart(null);
            };

            const currentCard = cards[currentIndex];

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-md mx-auto">
                        {/* Header */}
                        <header className="text-center mb-4">
                            <h1 className="text-2xl font-bold text-gray-800">Spanish Flashcards</h1>
                            <p className="text-sm text-gray-600 mt-1">Swipe or tap to study</p>
                        </header>

                        {/* Set Selector */}
                        <div className="mb-4">
                            <select 
                                value={selectedSet} 
                                onChange={(e) => { setSelectedSet(e.target.value); setCurrentIndex(0); setIsFlipped(false); }}
                                className="w-full px-3 py-2 bg-white border border-gray-300 rounded-lg shadow-sm focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500"
                            >
                                {Object.keys(dataSets).map(setName => (
                                    <option key={setName} value={setName}>{setName}</option>
                                ))}
                            </select>
                        </div>

                        {/* Mode Toggle & Counter */}
                        <div className="flex justify-between items-center mb-4">
                            <button onClick={handleModeToggle} className="px-3 py-1.5 bg-white rounded-lg shadow-sm border text-sm font-medium text-gray-700 hover:bg-gray-50">
                                {mode === 'spanish-to-english' ? 'ES → EN' : 'EN → ES'}
                            </button>
                            <div className="text-sm text-gray-600">{cards.length > 0 ? `${currentIndex + 1} / ${cards.length}` : '0 / 0'}</div>
                        </div>

                        {/* Flashcard */}
                        <div 
                            className="relative w-full h-64 cursor-pointer perspective-1000 mb-4"
                            onTouchStart={onTouchStart}
                            onTouchEnd={onTouchEnd}
                            onClick={(e) => { if (!touchStart) handleFlip(); }}
                        >
                            {currentCard ? (
                                <div className={`absolute inset-0 w-full h-full transition-transform duration-500 transform-style-preserve-3d ${isFlipped ? 'rotate-y-180' : ''}`}>
                                    {/* Front */}
                                    <div className="absolute inset-0 w-full h-full bg-white rounded-xl shadow-lg border-2 border-indigo-100 backface-hidden flex flex-col items-center justify-center p-4">
                                        <div className="text-xs uppercase tracking-wide text-gray-500 mb-2">{mode === 'spanish-to-english' ? 'Español' : 'English'}</div>
                                        <div className={`font-bold text-gray-800 text-center ${currentCard.type === 'phrase' ? 'text-2xl' : 'text-3xl'}`}>
                                            {mode === 'spanish-to-english' ? currentCard.spanish : currentCard.english}
                                        </div>
                                    </div>
                                    
                                    {/* Back */}
                                    <div className="absolute inset-0 w-full h-full bg-indigo-50 rounded-xl shadow-lg border-2 border-indigo-200 backface-hidden rotate-y-180 flex flex-col items-center justify-center p-4">
                                        <div className="text-xs uppercase tracking-wide text-indigo-600 mb-2">{mode === 'spanish-to-english' ? 'English' : 'Español'}</div>
                                        <div className={`font-bold text-indigo-800 text-center ${currentCard.type === 'phrase' ? 'text-2xl' : 'text-3xl'}`}>
                                            {mode === 'spanish-to-english' ? currentCard.english : currentCard.spanish}
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="absolute inset-0 w-full h-full bg-white rounded-xl shadow-lg border-2 border-gray-200 flex items-center justify-center">
                                    <div className="text-gray-500">No cards available</div>
                                </div>
                            )}
                        </div>
                        
                        {/* Navigation with Audio Button */}
                        <div className="flex justify-between items-center gap-2">
                            <button 
                                onClick={handlePrevious} 
                                disabled={currentIndex === 0 || cards.length === 0} 
                                className="px-3 py-2 bg-white rounded-lg shadow-sm border disabled:opacity-50 hover:bg-gray-50 flex items-center gap-1"
                            >
                                <ChevronLeftIcon />
                                <span className="text-sm">Previous</span>
                            </button>
                            
                            <div className="flex gap-2">
                                <button 
                                    onClick={handleReset} 
                                    disabled={cards.length === 0} 
                                    className="p-2 bg-white rounded-lg shadow-sm border hover:bg-gray-50 disabled:opacity-50"
                                    title="Reset to beginning"
                                >
                                    <RefreshIcon />
                                </button>
                                
                                <button 
                                    onClick={handleAudio} 
                                    disabled={cards.length === 0} 
                                    className="p-2 bg-white rounded-lg shadow-sm border hover:bg-gray-50 disabled:opacity-50"
                                    title="Play audio"
                                >
                                    <SpeakerIcon />
                                </button>
                            </div>
                            
                            <button 
                                onClick={handleNext} 
                                disabled={cards.length === 0 || currentIndex === cards.length - 1} 
                                className="px-3 py-2 bg-indigo-600 text-white rounded-lg shadow-sm disabled:opacity-50 hover:bg-indigo-700 flex items-center gap-1"
                            >
                                <span className="text-sm">Next</span>
                                <ChevronRightIcon />
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(SpanishFlashcards));
    </script>
</body>
</html>
